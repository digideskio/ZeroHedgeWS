(function(){var $$=this,$=this.IntelliFactory.Runtime,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;$.Define($$,{ZeroHedgeWS:{Client:{Ajax:function(A,B,C){var D;D=function(E){var F,G,H;F=E[0];G=E[1];E[2];H=a.ajax({url:B,type:A,contentType:"application/json",dataType:"text",data:C,success:function(I){return F(I);},error:function(J){return G(b.New1(J.responseText));}});return;};return c.FromContinuations(D);},GetPageArticles:function(K){return c.Delay(function(){var M;M="/api/page/"+$$.String(K);return c.Bind(e.Ajax("GET",M,null),function(N){var O;O=g.get_Default();return c.Return(((O.DecodeList(O.DecodeRecord(undefined,[["Title",h,0],["Introduction",h,0],["Body",h,0],["Reference",h,0],["Published",h,0],["Updated",O.DecodeDateTime(),0]])))())(i.parse(N)));});});},Main:function(){var P,Q,R,S,Y,Z,_4,_5;P=l.Create("id","blogItems");Q=m.Class("col-md-12");R=n.append([P],o.ofArray([Q]));S=c.Delay(function(){return c.Bind(e.GetPageArticles(p.Get(e["v'page"]())),function(U){var V;V=function(W){var X;X=W.Title;q?q.log(X):undefined;return e.postList().Add(W);};n.iter(V,U);return c.Return(null);});});c.Start(S,{$:0});Y=o.ofArray([l.Create("class","container top-padding-med ng-scope")]);Z=function(){var _1,_3;_1=function(_2){return e.doc(_2);};_3=s.View(e.postList());return r.Convert(_1,_3);};_4=e["v'blog"]();_5=t.Map(Z,_4);return r.Element("div",Y,o.ofArray([r.Element("div",R,o.ofArray([r.EmbedView(_5)]))]));},doc:function(_6){return r.Element("div",o.ofArray([m.Class("panel panel-primary")]),o.ofArray([e["doc'header"](_6),e["doc'body"](_6)]));},"doc'body":function(_7){var _8,_9,_,ba,bb,bc,bd,be,bf;_8=l.Create("class","container");_9=m.Style("margin-top","100px");_=n.append([_8],o.ofArray([_9]));ba=l.Create("placeholder","Title");bb=m.Class("form-control");bc=n.append([ba],o.ofArray([bb]));be=_7.Introduction;bd=a(u.toSafe("<div>")+u.toSafe(be)+u.toSafe("</div>")).get(0);bf=o.ofArray([r.TextNode(_7.Published)]);return r.Element("div",o.ofArray([m.Class("panel-body")]),o.ofArray([r.Static(bd),r.Element("p",[],bf)]));},"doc'header":function(bf){var bg,bh,bi,bj,bk,bl,bm;bg=bf.Title;q?q.log(bg):undefined;bi=bf.Title;bh=a(u.toSafe("<div>")+u.toSafe(bi)+u.toSafe("</div>")).get(0);bj=bf.Reference;bk=u.toSafe("/story/")+u.toSafe(bj);bl=l.Create("href",bk);bm=o.ofArray([bl]);return r.Element("div",o.ofArray([m.Class("panel-heading")]),o.ofArray([r.Element("a",bm,o.ofArray([r.Static(bh)]))]));},postList:$.Field(function(){var bn,bp;bn=function(bo){return $$.String(bo.Reference);};bp=$.New(v,{$:0});return w.Create(bn,bp);}),"v'blog":$.Field(function(){var bq,bt;bq=function(){return c.Delay(function(){return c.Return(e.postList());});};t.get_Do();bt=x.Const(1);return t.MapAsync(bq,bt);}),"v'page":$.Field(function(){return y.Create(1);})},StoryClient:{Ajax:function(bu,bv,bw){var bx;bx=function(by){var bz,bA,bB;bz=by[0];bA=by[1];by[2];bB=a.ajax({url:bv,type:bu,contentType:"application/json",dataType:"text",data:bw,success:function(bC){return bz(bC);},error:function(bD){return bA(b.New1(bD.responseText));}});return;};return c.FromContinuations(bx);},GetStory:function(bE){return c.Delay(function(){var bG;bG="/api/story/"+u.toSafe(bE);return c.Bind(z.Ajax("GET",bG,null),function(bH){if(q){q.log("Get zerohedge story");}g.get_Default();return c.Return((h())(i.parse(bH)));});});},Main:function(bI){var bJ,bK,bL,bM,bN,bO;bJ=l.Create("id","blogItems");bK=m.Class("col-md-12");bL=n.append([bJ],o.ofArray([bK]));bM=[""];bN="";bO="";c.Start(c.Delay(function(){return c.Bind(z.GetStory(bI),function(bQ){bM[0]=bQ;if(q){q.log(bQ);}return c.Return(null);});}),{$:0});return r.Element("div",o.ofArray([l.Create("class","container top-padding-med ng-scope")]),o.ofArray([r.Element("div",bL,o.ofArray([r.TextNode(bM[0])]))]));},doc:function(bR){return r.Element("div",o.ofArray([m.Class("panel panel-primary")]),o.ofArray([z["doc'header"](bR),z["doc'body"](bR)]));},"doc'body":function(bS){var bT,bU,bV,bW,bX,bY,bZ,b0,b1;bT=l.Create("class","container");bU=m.Style("margin-top","100px");bV=n.append([bT],o.ofArray([bU]));bW=l.Create("placeholder","Title");bX=m.Class("form-control");bY=n.append([bW],o.ofArray([bX]));b0=bS.Introduction;bZ=a(u.toSafe("<div>")+u.toSafe(b0)+u.toSafe("</div>")).get(0);b1=o.ofArray([r.TextNode(bS.Published)]);return r.Element("div",o.ofArray([m.Class("panel-body")]),o.ofArray([r.Static(bZ),r.Element("p",[],b1)]));},"doc'header":function(b2){var b3,b4,b5,b6,b7,b8,b9;b3=b2.Title;q?q.log(b3):undefined;b5=b2.Title;b4=a(u.toSafe("<div>")+u.toSafe(b5)+u.toSafe("</div>")).get(0);b6=b2.Reference;b7=u.toSafe("/story?ref=")+u.toSafe(b6);b8=l.Create("href",b7);b9=o.ofArray([b8]);return r.Element("div",o.ofArray([m.Class("panel-heading")]),o.ofArray([r.Element("a",b9,o.ofArray([r.Static(b4)]))]));}}}});$.OnInit(function(){a=$.Safe($$.jQuery);b=$.Safe($$.WebSharper.Exception);c=$.Safe($$.WebSharper.Concurrency);d=$.Safe($$.ZeroHedgeWS);e=$.Safe(d.Client);f=$.Safe($$.WebSharper.Json);g=$.Safe(f.Provider);h=$.Safe(g.Id);i=$.Safe($$.JSON);j=$.Safe($$.WebSharper.UI);k=$.Safe(j.Next);l=$.Safe(k.AttrProxy);m=$.Safe(k.AttrModule);n=$.Safe($$.WebSharper.Seq);o=$.Safe($$.WebSharper.List);p=$.Safe(k.Var1);q=$.Safe($$.console);r=$.Safe(k.Doc);s=$.Safe(k.ListModel1);t=$.Safe(k.View);u=$.Safe($$.WebSharper.PrintfHelpers);v=$.Safe(o.T);w=$.Safe(k.ListModel);x=$.Safe(k.View1);y=$.Safe(k.Var);return z=$.Safe(d.StoryClient);});$.OnLoad(function(){e["v'page"]();e["v'blog"]();e.postList();return;});}());
